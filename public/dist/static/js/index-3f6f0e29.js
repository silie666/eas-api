import{a as k,u as D,_ as $}from"./hooks-0bb16742.js";import{aw as g,ax as C,ay as A,az as m,aA as T,aB as x,aC as _,aD as V,aE as S,aF as R,d as f,W as F,n as L,r as P,o as E,i as H,j as y,e as U,f as d,ar as u,av as I,at as j,ad as z,au as w,aG as M,b as Q,c as N,w as W,h as Y,A as Z,B as G}from"./index-0c4eef95.js";import{B as q}from"./basic-simple-api-95f53e4e.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-ee62f579.js";import{a as K}from"./hooks-e9aede39.js";import"./search-cc37b371.js";import"./baseData-b6b081d1.js";const X=function(s){return{deleteTeacherApiCourseBill:async(e,l,t={})=>{x("deleteTeacherApiCourseBill","courseBillId",e);const p="/teacher-api/course-bills/{courseBillId}".replace("{courseBillId}",encodeURIComponent(String(e))),c=new URL(p,_);let a;s&&(a=s.baseOptions);const o={method:"DELETE",...a,...t},r={},i={};l!=null&&(r.Authorization=String(l)),V(c,i);let n=a&&a.headers?a.headers:{};return o.headers={...r,...n,...t.headers},{url:S(c),options:o}},getTeacherApiCourseBill:async(e,l,t={})=>{x("getTeacherApiCourseBill","courseBillId",e);const p="/teacher-api/course-bills/{courseBillId}".replace("{courseBillId}",encodeURIComponent(String(e))),c=new URL(p,_);let a;s&&(a=s.baseOptions);const o={method:"GET",...a,...t},r={},i={};l!=null&&(r.Authorization=String(l)),V(c,i);let n=a&&a.headers?a.headers:{};return o.headers={...r,...n,...t.headers},{url:S(c),options:o}},getTeacherApiCourseBills:async(e,l,t,p,c={})=>{const a="/teacher-api/course-bills",o=new URL(a,_);let r;s&&(r=s.baseOptions);const i={method:"GET",...r,...c},n={},h={};e!==void 0&&(h.page=e),l!==void 0&&(h.per_page=l),t!==void 0&&(h.status=t),p!=null&&(n.Authorization=String(p)),V(o,h);let B=r&&r.headers?r.headers:{};return i.headers={...n,...B,...c.headers},{url:S(o),options:i}},patchTeacherApiCourseBill:async(e,l,t,p={})=>{x("patchTeacherApiCourseBill","courseBillId",e);const c="/teacher-api/course-bills/{courseBillId}".replace("{courseBillId}",encodeURIComponent(String(e))),a=new URL(c,_);let o;s&&(o=s.baseOptions);const r={method:"PATCH",...o,...p},i={},n={};l!=null&&(i.Authorization=String(l)),i["Content-Type"]="application/json",V(a,n);let h=o&&o.headers?o.headers:{};return r.headers={...i,...h,...p.headers},r.data=R(t,r,s),{url:S(a),options:r}},patchTeacherApiCourseBillSend:async(e,l,t,p={})=>{x("patchTeacherApiCourseBillSend","courseBillId",e);const c="/teacher-api/course-bills/{courseBillId}/send".replace("{courseBillId}",encodeURIComponent(String(e))),a=new URL(c,_);let o;s&&(o=s.baseOptions);const r={method:"PATCH",...o,...p},i={},n={};l!=null&&(i.Authorization=String(l)),i["Content-Type"]="application/json",V(a,n);let h=o&&o.headers?o.headers:{};return r.headers={...i,...h,...p.headers},r.data=R(t,r,s),{url:S(a),options:r}},postTeacherApiCourseBills:async(e,l,t={})=>{const p="/teacher-api/course-bills",c=new URL(p,_);let a;s&&(a=s.baseOptions);const o={method:"POST",...a,...t},r={},i={};e!=null&&(r.Authorization=String(e)),r["Content-Type"]="application/json",V(c,i);let n=a&&a.headers?a.headers:{};return o.headers={...r,...n,...t.headers},o.data=R(l,o,s),{url:S(c),options:o}}}},b=function(s){const e=X(s);return{async deleteTeacherApiCourseBill(l,t,p){var r,i;const c=await e.deleteTeacherApiCourseBill(l,t,p),a=(s==null?void 0:s.serverIndex)??0,o=(i=(r=C["CourseCourseBillApi.deleteTeacherApiCourseBill"])==null?void 0:r[a])==null?void 0:i.url;return(n,h)=>A(c,T,m,s)(n,o||h)},async getTeacherApiCourseBill(l,t,p){var r,i;const c=await e.getTeacherApiCourseBill(l,t,p),a=(s==null?void 0:s.serverIndex)??0,o=(i=(r=C["CourseCourseBillApi.getTeacherApiCourseBill"])==null?void 0:r[a])==null?void 0:i.url;return(n,h)=>A(c,T,m,s)(n,o||h)},async getTeacherApiCourseBills(l,t,p,c,a){var n,h;const o=await e.getTeacherApiCourseBills(l,t,p,c,a),r=(s==null?void 0:s.serverIndex)??0,i=(h=(n=C["CourseCourseBillApi.getTeacherApiCourseBills"])==null?void 0:n[r])==null?void 0:h.url;return(B,v)=>A(o,T,m,s)(B,i||v)},async patchTeacherApiCourseBill(l,t,p,c){var i,n;const a=await e.patchTeacherApiCourseBill(l,t,p,c),o=(s==null?void 0:s.serverIndex)??0,r=(n=(i=C["CourseCourseBillApi.patchTeacherApiCourseBill"])==null?void 0:i[o])==null?void 0:n.url;return(h,B)=>A(a,T,m,s)(h,r||B)},async patchTeacherApiCourseBillSend(l,t,p,c){var i,n;const a=await e.patchTeacherApiCourseBillSend(l,t,p,c),o=(s==null?void 0:s.serverIndex)??0,r=(n=(i=C["CourseCourseBillApi.patchTeacherApiCourseBillSend"])==null?void 0:i[o])==null?void 0:n.url;return(h,B)=>A(a,T,m,s)(h,r||B)},async postTeacherApiCourseBills(l,t,p){var r,i;const c=await e.postTeacherApiCourseBills(l,t,p),a=(s==null?void 0:s.serverIndex)??0,o=(i=(r=C["CourseCourseBillApi.postTeacherApiCourseBills"])==null?void 0:r[a])==null?void 0:i.url;return(n,h)=>A(c,T,m,s)(n,o||h)}}};class O extends g{deleteTeacherApiCourseBill(e,l){return b(this.configuration).deleteTeacherApiCourseBill(e.courseBillId,e.authorization,l).then(t=>t(this.axios,this.basePath))}getTeacherApiCourseBill(e,l){return b(this.configuration).getTeacherApiCourseBill(e.courseBillId,e.authorization,l).then(t=>t(this.axios,this.basePath))}getTeacherApiCourseBills(e={},l){return b(this.configuration).getTeacherApiCourseBills(e.page,e.perPage,e.status,e.authorization,l).then(t=>t(this.axios,this.basePath))}patchTeacherApiCourseBill(e,l){return b(this.configuration).patchTeacherApiCourseBill(e.courseBillId,e.authorization,e.patchTeacherApiCourseBillRequest,l).then(t=>t(this.axios,this.basePath))}patchTeacherApiCourseBillSend(e,l){return b(this.configuration).patchTeacherApiCourseBillSend(e.courseBillId,e.authorization,e.body,l).then(t=>t(this.axios,this.basePath))}postTeacherApiCourseBills(e={},l){return b(this.configuration).postTeacherApiCourseBills(e.authorization,e.patchTeacherApiCourseBillRequest,l).then(t=>t(this.axios,this.basePath))}}const ee=f({__name:"BillForm",props:{row:{}},setup(s,{expose:e}){var a;const l=s,t=F({course_ids:((a=l==null?void 0:l.row)==null?void 0:a.course_ids)??""}),p=k(new q().getCommonApiCourses,"id"),c=L();return e({ruleFormRef:c,form:t}),(o,r)=>{const i=P("el-form-item"),n=P("el-form");return E(),H(n,{ref_key:"ruleFormRef",ref:c,model:t,"label-width":"100px"},{default:y(()=>[U(i,{label:d(u)("课程"),prop:"course_ids"},{default:y(()=>[U(J,{options:d(p),modelValue:t.course_ids,"onUpdate:modelValue":r[0]||(r[0]=h=>t.course_ids=h),"collapse-tags":"",multiple:"",placeholder:d(u)("课程")},null,8,["options","modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])}}});function ae(){const s=D(new O().getTeacherApiCourseBills),{getTableData:e}=s,l={add:{auth:I.POST_TEACHER_COURSE_BILLS,onClick(){c()}},edit:{auth:I.PATCH_TEACHER_COURSE_BILLS_BY_ID,onClick(a){c(u("编辑"),a)}},delete:{auth:I.DELETE_TEACHER_COURSE_BILLS_BY_ID,onConfirm({id:a}){s.handleDelete(new O().deleteTeacherApiCourseBill,{courseBillId:a})}}},t=[{label:u("序号"),type:"index",width:70},{label:u("课程名称"),prop:"courses",minWidth:90,cellRenderer:a=>{const o=[];let r;for(r of a.row.courses)a.row.course_ids.includes(r.id)&&o.push(r.name);return o.join(",")}},{label:u("是否已发送账单"),prop:"status_name",minWidth:130},{label:u("创建时间"),prop:"create_time",minWidth:130},{label:u("操作"),width:200,slot:"operation"}];function p(a){M.confirm("确认要发送账单?","系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",dangerouslyUseHTMLString:!0,draggable:!0}).then(async()=>{await new O().patchTeacherApiCourseBillSend({courseBillId:a.id.toString()}),w(u("操作成功"),{type:"success"}),await e()}).catch(()=>{w(u("操作失败"),{type:"error"})})}function c(a=u("新增"),o){const r=L();j({title:`${a}${u("账单")}`,width:"40%",draggable:!0,fullscreenIcon:!0,closeOnClickModal:!1,loading:!1,contentRenderer:()=>z(ee,{ref:r,row:o}),beforeSure:(i,{options:n})=>{const{form:h,ruleFormRef:B}=r.value;B.validate(async v=>{if(v){n.loading=!0;try{o?await new O().patchTeacherApiCourseBill({courseBillId:o.id.toString(),patchTeacherApiCourseBillRequest:h}):await new O().postTeacherApiCourseBills({patchTeacherApiCourseBillRequest:h}),w(`${a}成功`,{type:"success"}),i(),await e()}finally{n.loading=!1}}})}})}return{columns:t,onSend:p,hook:s,actionBtn:l}}const re={width:24,height:24,body:'<path fill="currentColor" d="M20 22H4a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1Zm-1-2V4H5v16h14ZM8 9h8v2H8V9Zm0 4h8v2H8v-2Z"/>'},se={class:"main"},he=f({name:"BillList",__name:"index",setup(s){const{columns:e,onSend:l,hook:t,actionBtn:p}=ae();return(c,a)=>{const o=P("el-button"),r=Q("auth");return E(),N("div",se,[U($,{title:c.$t("账单管理"),columns:d(e),hook:d(t),"action-btn":d(p)},{operation:y(({row:i,size:n})=>[i.status===!1?W((E(),H(o,{key:0,icon:d(K)(d(re)),size:n,class:"reset-margin",link:"",type:"primary",onClick:h=>d(l)(i)},{default:y(()=>[Y(Z(c.$t("发送账单")),1)]),_:2},1032,["icon","size","onClick"])),[[r,d(I).PATCH_TEACHER_COURSE_BILLS_BY_ID_SEND]]):G("",!0)]),_:1},8,["title","columns","hook","action-btn"])])}}});export{he as default};
